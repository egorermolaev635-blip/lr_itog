# Шифр Цезаря — Итоговая лабораторная работа

## Описание

Консольное приложение на C++, реализующее шифр Цезаря для шифрования и дешифрования текстов. Поддерживает русский и английский алфавиты, работает с данными в формате JSON, логирует операции и предоставляет удобный текстовый интерфейс.

**Вариант:** 4  
**Язык:** C++  
**Стандарт:** C++17  

---

## Структура проекта

```
caesar-cipher/
├── src/
│   ├── main.cpp              # Главная программа
│   ├── cipher.cpp            # Реализация шифра
│   ├── json_parser.cpp       # Парсер JSON
│   └── logger.cpp            # Логирование операций
├── include/
│   ├── cipher.h              # Заголовок шифра
│   ├── json_parser.h         # Заголовок парсера
│   └── logger.h              # Заголовок логгера
├── tests/
│   ├── test_cipher.cpp       # Тесты функций шифра
│   └── test_json.cpp         # Тесты парсера JSON
├── data/
│   ├── input.json            # Пример входных данных
│   ├── input_large.json      # Большой набор для бенчмарков
│   └── operations.log        # Лог операций
├── docs/
│   ├── Implementation_Plan.md # План реализации
│   ├── bench.md              # Отчёт о производительности
│   └── REPORT.md             # Полный отчёт
├── CMakeLists.txt            # Конфигурация сборки
├── .gitignore                # Git игнорирование
└── README.md                 # Этот файл
```

---

## Требования

- **Компилятор:** GCC 7+ / Clang 5+ / MSVC 2017+
- **CMake:** версия 3.10+
- **ОС:** Linux, macOS, Windows

---

## Сборка проекта

### Linux / macOS

```bash
# Клонирование репозитория
git clone [https://github.com/вашеимя/caesar-cipher.git](https://github.com/egorermolaev635-blip/lr_itog.git)
cd caesar-cipher

# Создание директории сборки
mkdir build
cd build

# Конфигурация с CMake
cmake ..

# Компиляция
make

# Запуск приложения
./caesar_cipher --help
```

### Windows (Visual Studio)

```bash
mkdir build
cd build
cmake .. -G "Visual Studio 16 2019"
cmake --build . --config Release
```

---

## Использование

### Справка по программе

```bash
./caesar_cipher --help
```

Выведет полное описание всех команд и опций.

### Основные сценарии использования

#### 1. Шифрование с интерактивным меню

```bash
./caesar_cipher
```

Запустит интерактивное меню с опциями:
- 1 — Загрузить данные из JSON
- 2 — Зашифровать текст
- 3 — Расшифровать текст
- 4 — Показать логи операций
- 0 — Выход

#### 2. Прямое шифрование из командной строки

```bash
./caesar_cipher --mode enc --key 7 --input data/input.json --output output.json
```

**Параметры:**
- `--mode enc` — режим шифрования (или `dec` для расшифровки)
- `--key N` — сдвиг (от 1 до 25 для англ., от 1 до 32 для русс.)
- `--input FILE` — входной JSON файл
- `--output FILE` — выходной JSON файл
- `--ids 1,2,3` — обработать только записи с этими ID (опционально)

#### 3. Пакетная обработка

```bash
./caesar_cipher --mode dec --key 7 --input data/input.json --ids 1,3,5 --output batch_out.json
```

#### 4. Генерация случайного ключа

```bash
./caesar_cipher --mode enc --key random --input data/input.json --output random_key.json
```

---

## Примеры входных данных (JSON)

### Пример 1: Простой текст

```json
[
  {
    "id": 1,
    "content": "Hello, World!"
  },
  {
    "id": 2,
    "content": "Привет, мир!"
  }
]
```

### Пример 2: Большой набор для тестирования

```json
[
  {
    "id": 1,
    "content": "The quick brown fox jumps over the lazy dog."
  },
  {
    "id": 2,
    "content": "Быстрая коричневая лиса прыгает через ленивую собаку."
  },
  {
    "id": 3,
    "content": "Mixed: Hello привет 123!"
  }
]
```

---

## Примеры выходных данных

### Зашифрованный текст (ключ = 7)

```json
[
  {
    "id": 1,
    "content": "Hello, World!",
    "encrypted": "Olmmp, Dsvmk!",
    "key": 7
  },
  {
    "id": 2,
    "content": "Привет, мир!",
    "encrypted": "Щщлмлш, элщ!",
    "key": 7
  }
]
```

### Лог операций

```json
[
  {
    "timestamp": "2025-12-21T22:05:30",
    "operation": "encrypt",
    "key": 7,
    "id": 1,
    "status": "успешно"
  },
  {
    "timestamp": "2025-12-21T22:05:31",
    "operation": "decrypt",
    "key": 7,
    "id": 1,
    "status": "успешно"
  }
]
```

---

## Запуск тестов

```bash
cd build
ctest --output-on-failure
```

Или запустить отдельные тесты:

```bash
./test_cipher
./test_json
```

---

## Бенчмаркинг

Для оценки производительности запустите:

```bash
./caesar_cipher --benchmark --size 10000
./caesar_cipher --benchmark --size 100000
```

Результаты сохранятся в `docs/bench.md`.

---

## Основные функции

### `encryptCaesar(const std::string& text, int key, char lang) -> std::string`

Шифрует текст с заданным ключом для указанного языка (русский/английский).

**Параметры:**
- `text` — исходный текст
- `key` — величина сдвига (1–25 для англ., 1–32 для русс.)
- `lang` — 'E' для английского, 'R' для русского

**Возвращает:** зашифрованный текст

### `decryptCaesar(const std::string& text, int key, char lang) -> std::string`

Дешифрует текст, используя обратный сдвиг.

### `isValidKey(int key, char lang) -> bool`

Проверяет, находится ли ключ в допустимом диапазоне.

### `generateRandomKey(char lang) -> int`

Генерирует случайный ключ для указанного языка.

---

## Обработка ошибок

Программа корректно обрабатывает:

- **Ошибочные ключи** → сообщение об ошибке с допустимым диапазоном
- **Пустой content** → пропускается с предупреждением
- **Невалидный JSON** → детальное сообщение с номером строки
- **Отсутствующие ID** → сообщение о том, что ID не найден
- **Ошибки файлового ввода/вывода** → попытка повторить или использовать дефолтное имя

Все сообщения об ошибках выводятся **на русском языке**.

---

## Результаты тестирования

Тесты включают:

-  Шифрование английского текста (ключи 1–25)
-  Шифрование русского текста (ключи 1–32)
-  Сохранение специальных символов и цифр
-  Регистр букв
-  Пустые строки и граничные случаи
-  Корректный парсинг и сохранение JSON
-  Логирование операций

Все тесты проходят успешно.

---

## Узкое место производительности

**Основной hotspot:** посимвольная обработка больших строк при шифровании/дешифровании.

На наборе из 100 000 записей по 1000 символов каждая:
- **Шифрование:** ~50–70 мс
- **Дешифрование:** ~50–70 мс

**Оптимизация:** использование `std::string::reserve()` и прямого доступа к символам вместо конкатенации.

Подробный отчёт в `docs/bench.md`.

---

## Автор и контактная информация

**Автор:** Ермолаев Егор
**Группа:** ПРИ-0-25/1  
**Дата:** 21 декабря 2025 г.

---

## Дополнительная информация

- **docs/Implementation_Plan.md** — детальный план реализации
- **docs/REPORT.md** — полный технический отчёт
- **docs/bench.md** — результаты бенчмарков
- **tests/** — исходный код тестов

---
