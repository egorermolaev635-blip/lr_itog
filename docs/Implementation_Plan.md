# План реализации: Шифр Цезаря

## 1. Краткое описание задачи

Разработать консольное приложение на C++, которое реализует классический шифр Цезаря для шифрования и дешифрования текстов. Программа должна:
- Работать с текстами на русском и английском языках
- Загружать и сохранять данные в формате JSON
- Предоставлять удобный интерфейс (интерактивное меню и командная строка)
- Логировать все операции

## 2. Цель и ожидаемый результат

**Цель:** создать полнофункциональное консольное приложение, демонстрирующее практическое применение базовых знаний C++.

**Ожидаемый результат:**
- Работающая программа с интерактивным меню на русском языке
- Примеры входных и выходных JSON файлов
- Лог операций в формате JSON
- Отчёт о производительности с бенчмарками
- Набор юнит-тестов
- Полная документация на русском языке
- GitHub репозиторий с правильной структурой

## 3. Этапы и задачи реализации

### Этап 1: Анализ и планирование 

**Задачи:**
1. Изучить требования задания и критерии оценки
2. Определить структуру данных JSON
3. Спроектировать архитектуру приложения (модули, классы)
4. Подготовить план с примерами
5. Создать репозиторий GitHub и основную структуру проекта

**Результаты:**
- docs/Implementation_Plan.md (этот файл)
- Пустая структура папок
- .gitignore и README (заготовка)

---

### Этап 2: Базовая реализация шифра 

**Задачи:**
1. Реализовать функции шифрования для английского текста
   - `encryptCaesar(string text, int key) -> string`
   - `decryptCaesar(string text, int key) -> string`
2. Реализовать функции для русского текста
   - Учесть различие в размере алфавита (26 vs 33)
3. Добавить валидацию ключей (1–25 для англ., 1–32 для русс.)
4. Обработать специальные символы (не шифруются)

**Результаты:**
- include/cipher.h (заголовочный файл)
- src/cipher.cpp (реализация)

**Прототип функций:**
```cpp
std::string encryptCaesar(const std::string& text, int key, char lang);
std::string decryptCaesar(const std::string& text, int key, char lang);
bool isValidKey(int key, char lang);
int generateRandomKey(char lang);
```

---

### Этап 3: JSON парсер и сохранение 

**Задачи:**
1. Реализовать парсер для минимального подмножества JSON:
   - Объекты `{...}`
   - Массивы `[...]`
   - Строки (с экранированием `\"`, `\\`, `\n`)
   - Числа и логические значения
2. Реализовать функции загрузки и сохранения JSON
3. Добавить валидацию входных данных
4. Обработка ошибок с указанием строки/позиции

**Результаты:**
- include/json_parser.h
- src/json_parser.cpp

**Прототип функций:**
```cpp
struct JsonValue { /* ... */ };
JsonValue parseJson(const std::string& jsonStr);
std::vector<std::map<std::string, JsonValue>> loadFromFile(const std::string& filename);
void saveToFile(const std::string& filename, const std::vector<std::map<std::string, JsonValue>>& data);
```

---

### Этап 4: Логирование операций 

**Задачи:**
1. Создать структуру для логирования:
   - Временная метка (ISO 8601)
   - Операция (encrypt/decrypt)
   - Ключ
   - ID записи
   - Статус (успешно/ошибка)
   - Сообщение об ошибке (если есть)
2. Реализовать логгер для записи в JSON
3. Функции вывода логов в таблице

**Результаты:**
- include/logger.h
- src/logger.cpp

---

### Этап 5: Интерфейс командной строки 

**Задачи:**
1. Реализовать парсер аргументов командной строки:
   - `--help` — справка
   - `--mode {enc|dec}` — режим
   - `--key N` — ключ (или `random`)
   - `--input FILE` — входной файл
   - `--output FILE` — выходной файл
   - `--ids 1,2,3` — выборочная обработка
2. Обработка ошибок при неправильных аргументах
3. Вывод справки на русском языке

**Результаты:**
- Функции парсинга в main.cpp

---

### Этап 6: Интерактивное меню 

**Задачи:**
1. Реализовать главное меню:
   - 1 — Загрузить данные из JSON
   - 2 — Зашифровать текст (выбор ключа, ID)
   - 3 — Расшифровать текст
   - 4 — Показать логи
   - 5 — Сохранить результаты
   - 0 — Выход
2. Валидация пользовательского ввода
3. Повтор ввода при ошибках
4. Подтверждение перезаписи файла

**Результаты:**
- Функция `interactiveMenu()` в main.cpp

---

### Этап 7: Обработка ошибок и граничные случаи 

**Задачи:**
1. Обработать все указанные ошибки:
   - Невалидный ключ → подсказка диапазона
   - Пустой content → пропуск с предупреждением
   - Битый JSON → сообщение с позицией
   - Отсутствующий файл → уточняющий вопрос
   - ID не найден → перечень доступных
2. Все сообщения на русском языке
3. Подробные описания проблемы и рекомендации

**Результаты:**
- Функция `printError(string msg)` и др.
- Обновлены все модули с проверками

---

### Этап 8: Тестирование 

**Задачи:**
1. Написать юнит-тесты для функций шифра:
   - Правильность шифрования (англ./русс.)
   - Сохранение спецсимволов
   - Граничные ключи (1 и макс)
   - Дешифрование = обратное к шифрованию
2. Тесты для парсера JSON
3. Интеграционные тесты (загрузка → обработка → сохранение)

**Результаты:**
- tests/test_cipher.cpp
- tests/test_json.cpp
- Лог прогона тестов в docs/

---

### Этап 9: Бенчмаркинг и оптимизация 

**Задачи:**
1. Подготовить тестовые данные:
   - 10 000 записей × 100 символов
   - 50 000 записей × 100 символов
   - 100 000 записей × 100 символов
2. Измерить время шифрования и дешифрования
3. Использовать `std::chrono::high_resolution_clock`
4. Выявить узкое место (посимвольная обработка)
5. Применить оптимизацию (reserve, direct indexing)

**Результаты:**
- data/input_large.json (несколько вариантов)
- docs/bench.md с таблицами и анализом

---

### Этап 10: Документация и оформление 

**Задачи:**
1. Заполнить README с инструкциями
2. Написать техотчёт (docs/REPORT.md):
   - Титульный лист
   - Описание задачи
   - Структура проекта
   - Ключевые алгоритмы
   - Примеры использования
   - Результаты тестов
   - Выводы
3. Создать примеры выходных файлов
4. Скриншоты работы программы

**Результаты:**
- README.md (полный)
- docs/REPORT.md
- docs/bench.md
- Примеры в data/

---

## 4. План-график

| Этап | Содержание | Статус |
|------|-----------|--------|
| 1 | Анализ и планирование | Выполнено |
| 2 | Реализация шифра | Выполнено |
| 3 | JSON парсер | Выполнено |
| 4 | Логирование | Выполнено |
| 5 | CLI интерфейс | Выполнено |
| 6 | Интерактивное меню | Выполнено |
| 7 | Обработка ошибок | Выполнено |
| 8 | Тестирование | Выполнено |
| 9 | Бенчмаркинг | Выполнено |
| 10 | Документация | Выполнено |

---

## 5. Ресурсы

### Язык и среда
- **Язык:** C++17 (стандарт)
- **IDE:** Visual Studio Code / CLion / Visual Studio
- **Компилятор:** GCC 7+ / Clang 5+ / MSVC 2017+
- **Сборка:** CMake 3.10+

### Справочная документация
- cppreference.com — документация стандартной библиотеки
- learncpp.com — учебник по C++
- JSON.org — описание формата JSON

### Примеры файлов
- data/input.json — простой пример
- data/input_large.json — большой набор для тестов

### Инструменты
- Git / GitHub — контроль версий и размещение проекта
- CMake — конфигурация сборки
- ctest — запуск тестов
- std::chrono — бенчмаркинг

---

## Ожидаемые результаты по завершении

1.  Работающее консольное приложение с меню на русском
2.  Корректное шифрование/дешифрование (англ. + русс.)
3.  JSON парсер и сохранение данных
4.  Логирование операций
5.  Набор примеров входных/выходных файлов
6.  Юнит-тесты с отчётом о прогоне
7.  Бенчмарки производительности
8.  Полная документация на русском
9.  GitHub репозиторий с правильной структурой
10.  Один Pull Request для эмуляции code review

---

## Примечания

- Шифр реализуется без использования внешних криптографических библиотек
- JSON парсер пишется с нуля для демонстрации навыков работы со строками и алгоритмами
- Производительность оптимизируется на уровне алгоритмов и использования памяти
- Все сообщения пользователю выводятся на русском языке
